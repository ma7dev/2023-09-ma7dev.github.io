<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Linux vs. FreeBSD vs. Windows" /><meta name="author" content="Mazen Alotaibi" /><meta property="og:locale" content="en" /><meta name="description" content="Introduction" /><meta property="og:description" content="Introduction" /><link rel="canonical" href="https://ma7.dev/posts/linux-vs-freebsd-vs-windows/" /><meta property="og:url" content="https://ma7.dev/posts/linux-vs-freebsd-vs-windows/" /><meta property="og:site_name" content="Mazen" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-12-06T00:00:00-08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Linux vs. FreeBSD vs. Windows" /><meta name="twitter:site" content="@ma7dev" /><meta name="twitter:creator" content="@Mazen Alotaibi" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Mazen Alotaibi"},"dateModified":"2022-06-29T04:45:35-07:00","datePublished":"2018-12-06T00:00:00-08:00","description":"Introduction","headline":"Linux vs. FreeBSD vs. Windows","mainEntityOfPage":{"@type":"WebPage","@id":"https://ma7.dev/posts/linux-vs-freebsd-vs-windows/"},"url":"https://ma7.dev/posts/linux-vs-freebsd-vs-windows/"}</script><title>Linux vs. FreeBSD vs. Windows | Mazen</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mazen"><meta name="application-name" content="Mazen"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"> <script src="https://cdn.jsdelivr.net/combine/npm/katex@0.15.3/dist/katex.min.js,npm/pseudocode@latest/build/pseudocode.min.js,gh/sbstjn/timesheet.js@master/dist/timesheet.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_2440352_86vrobdp9vu.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_2451185_tgvgeuen2lh.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@5.2/distr/fira_code.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sbstjn/timesheet.js@master/dist/timesheet.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Mazen</a></div><div class="site-subtitle font-italic">thinking out loud</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="iconfont icon-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="iconfont icon-qzone ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="iconfont icon-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="iconfont icon-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="iconfont icon-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="bi bi-person-lines-fill ml-xl-3 mr-xl-3 unloaded"></i> <span>REACH OUT</span> </a><li class="nav-item"> <a href="/lists/" class="nav-link"> <i class="bi bi-list-columns-reverse ml-xl-3 mr-xl-3 unloaded"></i> <span>LISTS</span> </a><li class="nav-item"> <a href="/now/" class="nav-link"> <i class="bi bi-cone-striped ml-xl-3 mr-xl-3 unloaded"></i> <span>NOW</span> </a><li class="nav-item"> <a href="/setup/" class="nav-link"> <i class="bi bi-display ml-xl-3 mr-xl-3 unloaded"></i> <span>SETUP</span> </a><li class="nav-item"> <a href="/stack/" class="nav-link"> <i class="bi bi-stack ml-xl-3 mr-xl-3 unloaded"></i> <span>STACK</span> </a><li class="nav-item"> <a href="/subdomains/" class="nav-link"> <i class="iconfont icon-buywebhostingstep1domain ml-xl-3 mr-xl-3 unloaded"></i> <span>SUBDOMAINS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="iconfont icon-adjust1"></i> </button> <span class="icon-border"><br></span> <a href="https://twitter.com/ma7dev" aria-label="twitter" > <i class="iconfont icon-twitter"></i> </a> <a href="https://github.com/ma7dev" aria-label="github" target="_blank" rel="noopener"> <i class="iconfont icon-github"></i> </a> <a href="https://linkedin.com/in/ma7dev" aria-label="linkedin" target="_blank" rel="noopener"> <i><svg xmlns='http://www.w3.org/2000/svg' width='1em' height='1em' preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' style="margin-bottom: 5px"><path fill='currentColor' d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"/> </svg> </i> </a> <a href="https://twitch.tv/ma7dev" aria-label="twitch" target="_blank" rel="noopener"> <i><svg xmlns='http://www.w3.org/2000/svg' width='1em' height='1em' preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' style="margin-bottom: 5px"><path d="M2.149 0l-1.612 4.119v16.836h5.731v3.045h3.224l3.045-3.045h4.657l6.269-6.269v-14.686h-21.314zm19.164 13.612l-3.582 3.582h-5.731l-3.045 3.045v-3.045h-4.836v-15.045h17.194v11.463zm-3.582-7.343v6.262h-2.149v-6.262h2.149zm-5.731 0v6.262h-2.149v-6.262h2.149z" fill="currentColor"/> </svg> </i> </a> <a href="https://youtube.com/@ma7dev" aria-label="youtube" target="_blank" rel="noopener"> <i><svg xmlns='http://www.w3.org/2000/svg' width='1em' height='1em' preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' style="margin-bottom: 5px"><path fill="currentColor" d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/> </svg> </i> </a> <a href=" javascript:location.href = 'mailto:' + ['sudomaze','gmail.com'].join('@')" aria-label="email" > <i class="iconfont icon-mail"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="iconfont icon-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Linux vs. FreeBSD vs. Windows</span> </span> <i id="sidebar-trigger" class="iconfont icon-bars"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="iconfont icon-search"></i> <span id="search-wrapper" class="align-items-center"> <i class="iconfont icon-search"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Linux vs. FreeBSD vs. Windows</h1><div class="post-meta text-muted"><div> By <em> <a href="https://ma7.dev/">Mazen Alotaibi</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1544083200" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2018-12-06 </em> </span> <span> Updated <em class="timeago" data-ts="1656503135" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-29 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3605 words"> <em>20 min</em> read</span></div></div></div><div class="post-content"><h2 id="introduction"><span class="mr-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h2></h2><p>This paper presents a comparison between Linux, FreeBSD, and Windows in three areas: concurrency, I/O, and memory management. In addition, in each area, I will discussing about the differences and similarities between them.</p><h2 id="concurrency-comparison"><span class="mr-2">Concurrency Comparison</span><a href="#concurrency-comparison" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h2></h2><p>In this section, I will be discussing about processes, threads, CPU scheduling, and other related information that I have found interesting for each operating system based on my research.</p><h3 id="linux"><span class="mr-2">Linux</span><a href="#linux" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h3></h3><p>Each process provides the resources needed to execute a program. A process has a virtual address space, executable code, open handles to system objects, a security context, a unique process identifier, environment variables, a priority class, minimum and maximum working set sizes, and at least one thread of execution. Each process is started with a single thread, often called the primary thread, but can create additional threads from any of its threads <sup id="fnref:f1" role="doc-noteref"><a href="#fn:f1" class="footnote" rel="footnote">1</a></sup>.</p><p>To create a process in Linux, we will need to use <em>Fork() system call</em>, which creates a new process, called the child process, from the exiting process, called the parent process. The child process has its own process ID (PID). <em>Fork()</em> takes no argument and return process ID. <em>Fork()</em> returns negative value if the process isn’t created, zero if the child process is created, and positive value and a child process ID if <em>Fork()</em> returns from parent process. In addition, system call <em>Fork()</em> duplicate the same address space of the parent process and allocate to the child process. However, the child process doesn’t inherit timer and semaphore adjustment from the parent process <sup id="fnref:f2" role="doc-noteref"><a href="#fn:f2" class="footnote" rel="footnote">2</a></sup>.</p><p>The following code sample demonstrates how to create a process in Linux <sup id="fnref:f3" role="doc-noteref"><a href="#fn:f3" class="footnote" rel="footnote">3</a></sup>:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="iconfont icon-code small"></i></span> <span class="code-header-right"><button class="button-copy" aria-label="copy" title-succeed="Copied!"><i class="iconfont icon-copy"></i></button></span></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;errno.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/wait.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">pid_t</span> <span class="n">child_pid</span><span class="p">;</span>
    <span class="n">child_pid</span> <span class="o">=</span> <span class="n">fork</span> <span class="p">(</span> <span class="p">);</span>                                    <span class="c1">// Create a new child process;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">child_pid</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">child_pid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">printf</span> <span class="p">(</span><span class="s">"child process successfully created!!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
            <span class="n">printf</span> <span class="p">(</span><span class="s">"child PID =  %d, parent PID = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">getpid</span><span class="p">(</span> <span class="p">),</span> <span class="n">getppid</span><span class="p">(</span> <span class="p">)</span> <span class="p">);</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
         <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">perror</span><span class="p">(</span><span class="s">"fork"</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Threads of execution, often shortened to threads, are the objects of activity within the process. Each thread includes a unique program counter, process stack, and set of processor registers. The kernel schedules individual threads, not processes. In traditional Unix systems, each process consists of one thread. In modern systems, however, multi-threaded programs consist of more than one thread are common <sup id="fnref:f1:1" role="doc-noteref"><a href="#fn:f1" class="footnote" rel="footnote">1</a></sup>.</p><h3 id="freebsd"><span class="mr-2">FreeBSD</span><a href="#freebsd" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h3></h3><p>A process is a program in execution. Each process has an address space containing a mapping of its program’s object code and global variables, a set of kernel resources that it can name and on which it can operate using system calls, and at least one and possibly many threads that execute its code. Every process in the system is assigned a unique identifier termed the process identifier (PID). An PID is a common mechanism used by applications and by the kernel to reference processes and it is used by applications when the latter send a signal to a process and when receiving the exit status from a deceased process. There are two PIDs that are special important to to each process: the PID of the process itself and the PID of the process’s parent process. A process structure contains information that must always remain resident in main memory, along with references to other structures that remain resident <sup id="fnref:f4" role="doc-noteref"><a href="#fn:f4" class="footnote" rel="footnote">4</a></sup>.</p><p>Every thread represents a virtual processor with a full context worth of register state and its own stack mapped into the address space. In addition, every thread running in the process has a corresponding kernel thread, with its own kernel stack that represents the user thread when it is executing in the kernel as a result of a system call, page fault, or signal delivery. The threads of a process operate in either user mode or kernel mode. In user mode, a thread executes application code with the machine in a non-privileged protection mode. Thread structure tracks information that needs to be resident only when the process is executing such as its kernel run-time stack. Both, process and thread, structures are allocated dynamically as part of process creation and are freed when the process is destroyed as it exits <sup id="fnref:f4:1" role="doc-noteref"><a href="#fn:f4" class="footnote" rel="footnote">4</a></sup>.</p><p>The FreeBSD timeshare scheduler uses a priority-based scheduling policy that is biased to favor interactive programs, such as text editors, over long-running batch-type jobs. Interactive programs tend to exhibit short bursts of computation followed by periods of inactivity or I/O. The scheduling policy initially assigns a high execution priority to each thread and allows that thread to execute for a fixed time slice <sup id="fnref:f4:2" role="doc-noteref"><a href="#fn:f4" class="footnote" rel="footnote">4</a></sup>.</p><h3 id="windows"><span class="mr-2">Windows</span><a href="#windows" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h3></h3><p>A process is basically a program in execution. The execution of a process must progress in a sequential fashion. Each process is uniquely identified by a number called a <em>process ID</em> (PID). Similar to files, each process has one owner and group, and the owner and group permissions are used to determine which files and devices the process can open <sup id="fnref:f5" role="doc-noteref"><a href="#fn:f5" class="footnote" rel="footnote">5</a></sup>.</p><p>In addition, to create a process in Windows, we will need to use CreateProcess function. CreateProcess function runs independently of the creating process, and the following code sample demonstrates how to create a process <sup id="fnref:f5:1" role="doc-noteref"><a href="#fn:f5" class="footnote" rel="footnote">5</a></sup>:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="iconfont icon-code small"></i></span> <span class="code-header-right"><button class="button-copy" aria-label="copy" title-succeed="Copied!"><i class="iconfont icon-copy"></i></button></span></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;windows.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;tchar.h&gt;</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">_tmain</span><span class="p">(</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">TCHAR</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">STARTUPINFO</span> <span class="n">si</span><span class="p">;</span>
    <span class="n">PROCESS_INFORMATION</span> <span class="n">pi</span><span class="p">;</span>
    <span class="n">ZeroMemory</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">si</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">si</span><span class="p">)</span> <span class="p">);</span>
    <span class="n">si</span><span class="p">.</span><span class="n">cb</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">si</span><span class="p">);</span>
    <span class="n">ZeroMemory</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">pi</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">argc</span> <span class="o">!=</span> <span class="mi">2</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Usage: %s [cmdline]</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// Start the child process.</span>
    <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="n">CreateProcess</span><span class="p">(</span> <span class="nb">NULL</span><span class="p">,</span>   <span class="c1">// No module name (use command line)</span>
        <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>        <span class="c1">// Command line</span>
        <span class="nb">NULL</span><span class="p">,</span>           <span class="c1">// Process handle not inheritable</span>
        <span class="nb">NULL</span><span class="p">,</span>           <span class="c1">// Thread handle not inheritable</span>
        <span class="n">FALSE</span><span class="p">,</span>          <span class="c1">// Set handle inheritance to FALSE</span>
        <span class="mi">0</span><span class="p">,</span>              <span class="c1">// No creation flags</span>
        <span class="nb">NULL</span><span class="p">,</span>           <span class="c1">// Use parent's environment block</span>
        <span class="nb">NULL</span><span class="p">,</span>           <span class="c1">// Use parent's starting directory</span>
        <span class="o">&amp;</span><span class="n">si</span><span class="p">,</span>            <span class="c1">// Pointer to STARTUPINFO structure</span>
        <span class="o">&amp;</span><span class="n">pi</span> <span class="p">)</span>           <span class="c1">// Pointer to PROCESS_INFORMATION structure</span>
    <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">"CreateProcess failed (%d).</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">()</span> <span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// Wait until child process exits.</span>
    <span class="n">WaitForSingleObject</span><span class="p">(</span> <span class="n">pi</span><span class="p">.</span><span class="n">hProcess</span><span class="p">,</span> <span class="n">INFINITE</span> <span class="p">);</span>
    <span class="c1">// Close process and thread handles.</span>
    <span class="n">CloseHandle</span><span class="p">(</span> <span class="n">pi</span><span class="p">.</span><span class="n">hProcess</span> <span class="p">);</span>
    <span class="n">CloseHandle</span><span class="p">(</span> <span class="n">pi</span><span class="p">.</span><span class="n">hThread</span> <span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Windows implements a priority-driven, preemptive scheduling system, at least one of the highest priority ready threads always runs, with the caution that certain high-priority threads ready to run might be limited by the processors on which they might be allowed or preferred to run on, a phenomenon called processor affinity <sup id="fnref:f6" role="doc-noteref"><a href="#fn:f6" class="footnote" rel="footnote">6</a></sup>.</p><h3 id="general-discussion"><span class="mr-2">General Discussion</span><a href="#general-discussion" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h3></h3><p>From my research, they all have similar processes features and behaviors, and Windows’ threads are similar to FreeBSD in the current model and the interface definition for Windows’ threads are similar to Linux. In addition, FreeBSD and Windows have a similar CPU scheduling as they both use priority-queues. <sup id="fnref:f1:2" role="doc-noteref"><a href="#fn:f1" class="footnote" rel="footnote">1</a></sup><sup id="fnref:f2:1" role="doc-noteref"><a href="#fn:f2" class="footnote" rel="footnote">2</a></sup><sup id="fnref:f4:3" role="doc-noteref"><a href="#fn:f4" class="footnote" rel="footnote">4</a></sup><sup id="fnref:f5:2" role="doc-noteref"><a href="#fn:f5" class="footnote" rel="footnote">5</a></sup><sup id="fnref:f6:1" role="doc-noteref"><a href="#fn:f6" class="footnote" rel="footnote">6</a></sup>.</p><h2 id="io-comparison"><span class="mr-2">IO Comparison</span><a href="#io-comparison" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h2></h2><p>In this section, I will be discussing about I/O (block and character), data structures, algorithms, cryptography, I/O scheduling, types of devices, and other related information that I have found interesting for each operating system based on my research.</p><h3 id="freebsd-1"><span class="mr-2">FreeBSD</span><a href="#freebsd-1" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h3></h3><p>The basic model of the UNIX I/O system is a sequence of bytes that can be accessed either randomly or sequentially, and there aren’t any access methods and control blocks in typical UNIX user process. Different programs expect various levels of structure, but the kernel doesn’t impose structure on I/O. In addition, UNIX processes use a descriptor to reference I/O streams. Descriptors are small unsigned integers obtained from the open and socket system calls. Read and write system calls can be applied to descriptors to transfer data, and close system call can be used to dead-locate any descriptor. There are three types of descriptors, files, pipes, and sockets. Files are linear array bytes, has at least one name, exists until all its names are deleted explicitly, and no process holds a descriptor for it. Pipes are a linear array of bytes, no name, used as an I/O stream, it is unidirectional, and created by a pipe system call. Sockets are transient objects, used for interprocess communication, exists only as long as some process holds a descriptor referring to it, and created by a socket system call. Furthermore, hardware devices can be categorized as either block (structure) or character (unstructured). For block devices, they are typified by disks and magnetic tapes, the kernel supports read-modify-write-type buffering actions on block-oriented structured devices to allow latter to be read and written in a totally random byte addressed fashion, and the filesystems are created on block devices. For character devices, they are communication lines, raster plotters, and unbuffered magnetic tapes and disks, and are support large block I/O transfers <sup id="fnref:f7" role="doc-noteref"><a href="#fn:f7" class="footnote" rel="footnote">7</a></sup>.</p><p>For previous editions of stream I/O system, the stream I/O system was based on the UNIX character I/O system, which allows a user process to open a way terminal port and then to insert appropriated kernel-processing modules and the modules that are being processed by the network protocols can be inserted in the appreciated kernel-processing modules. In addition, stacking a terminal-processing module on top of a network-processing module allowed flexible and efficient implementation of the network viral terminals within the kernel. In newer editions of stream I/O system ,such as 18th edition which was adopted in System V. However, the design of the networking facilities for 4.2BSD changed its approach based on the socket interface and flexible multi-player network architecture, which allows a single system to support multiple sets of networking protocols with stream, datagram, and other types of access. In addition, the user application and the kernel operate independently of each other for security. In 4.4BSD, the kernel doesn’t store I/O control blocks or other operating-system-related data structures in the application address space. Each user-level application is provided with an independent address space in which it executes its applications/processes. Moreover, the kernel makes most of the state changes invisible to the processes involved <sup id="fnref:f7:1" role="doc-noteref"><a href="#fn:f7" class="footnote" rel="footnote">7</a></sup>.</p><p>FreeBSD supports two different disk encryption methods, GBDE and GELI, and both of the methods support different cryptographic algorithms that counter different threats. For GBDE, it is high-security (protecting the user as protecting the data), cryptographic key provided by the user, and when the key is lost, the data can’t be accessed. On the other hand, GELI protects the data but doesn’t protect the user, it uses FreeBSD’s cryptographic device driver, and takes advantage of its transparently <sup id="fnref:f8" role="doc-noteref"><a href="#fn:f8" class="footnote" rel="footnote">8</a></sup>.</p><h3 id="windows-1"><span class="mr-2">Windows</span><a href="#windows-1" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h3></h3><p>The design goals for the Windows I/O system are to provide an abstraction of devices, both hardware and software to application with a selected features of the operating system, such as uniform security, high-performance asynchronous, high-level language support, etc. Windows I/O system is responsible for the connection between user model functionality, storage, and drivers with WDM WMI Routines, PnP Manager, Power Manager, and I/O Manager. For I/O Manager, it is the core of the Windows I/O system because it defines the order of the framework within which I/O requests are delivered to device drivers. Most I/O requests are represented as I/O Request Packet (IRP), which travels from one I/O system component to another. The design of Windows I/O system allows an individual application thread to manage multiple I/O requests concurrently <sup id="fnref:f9" role="doc-noteref"><a href="#fn:f9" class="footnote" rel="footnote">9</a></sup>.</p><p>Moreover, I have found 4 interesting algorithms built within the driver structure, Initialization Routine, Opening Devices, IRP, and Completing an I/O Request. For the Initialization Routine, the I/O manager executes a driver’s Initialization Routine when it loads the driver into the operating system. Then, the Initialization Routine fills in the system data structures to register the rest of the driver’s routines with the I/O manager and performs any global driver initialization that is necessary. For the Opening Devices, a file object is in a kernel model data structure that represents a handle to a device, and this process allows synchronization and easy manipulation of the object files. For IRP, the IRP is where the I/O system stores information it needs to process an I/O request, so when a thread calls an I/O API, the I/O manager constructs an IRP to represent the operation as it progresses through the I/O system. For Completing an I/O Request, it starts when a driver calls IoCompleteRequest to inform the I/O manager that has completed process teh request specified in the IRP <sup id="fnref:f9:1" role="doc-noteref"><a href="#fn:f9" class="footnote" rel="footnote">9</a></sup>.</p><p>I have found a good example<sup id="fnref:f10" role="doc-noteref"><a href="#fn:f10" class="footnote" rel="footnote">10</a></sup> of how to use IoCompleteRequest in a Windows machine to implement Completing an I/O Request.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="iconfont icon-code small"></i></span> <span class="code-header-right"><button class="button-copy" aria-label="copy" title-succeed="Copied!"><i class="iconfont icon-copy"></i></button></span></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>NTSTATUS CompleteRequest<span class="o">(</span>PIRP Irp, NTSTATUS status, ULONG_PTR Information<span class="o">)</span>
<span class="o">{</span>
    Irp-&gt;IoStatus.Status <span class="o">=</span> status<span class="p">;</span>
    Irp-&gt;IoStatus.Information <span class="o">=</span> Information<span class="p">;</span>
    IoCompleteRequest<span class="o">(</span>Irp, IO_NO_INCREMENT<span class="o">)</span><span class="p">;</span>
    <span class="k">return </span>status<span class="p">;</span>
<span class="o">}</span>
</pre></table></code></div></div><h3 id="general-discussion-1"><span class="mr-2">General Discussion</span><a href="#general-discussion-1" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h3></h3><p>A comparison between FreeBSD, Linux, and Windows 2000, that FreeBSD and Linux have higher security compared to Windows 2000 because they are both open source and Windows 2000 is closed, which means the main developers need to detect errors in the system by themselve. However, FreeBSD has higher security than Linux beucase FreeBSD requires third parties verification of the system compared to Linux, which can accepts updates from anyone with minor verification. In addition, Windows 2000 is supported by most of device manufactures because its layered architecture and generic use of objects <sup id="fnref:f11" role="doc-noteref"><a href="#fn:f11" class="footnote" rel="footnote">11</a></sup><sup id="fnref:f12" role="doc-noteref"><a href="#fn:f12" class="footnote" rel="footnote">12</a></sup>.</p><p>To sum up, it seems that FreeBSD has a Linux-like I/O system strcture compared to Windows which treats every file as an object. In addition, FreeBSD has higher security than Linux and Windows because FreeBSD has different methods to protect data. However, Windows is supported by most of device manufactures because its layered architecture and generic use of objects <sup id="fnref:f7:2" role="doc-noteref"><a href="#fn:f7" class="footnote" rel="footnote">7</a></sup><sup id="fnref:f8:1" role="doc-noteref"><a href="#fn:f8" class="footnote" rel="footnote">8</a></sup><sup id="fnref:f9:2" role="doc-noteref"><a href="#fn:f9" class="footnote" rel="footnote">9</a></sup><sup id="fnref:f11:1" role="doc-noteref"><a href="#fn:f11" class="footnote" rel="footnote">11</a></sup><sup id="fnref:f12:1" role="doc-noteref"><a href="#fn:f12" class="footnote" rel="footnote">12</a></sup>.</p><h2 id="memory-management-comparison"><span class="mr-2">Memory Management Comparison</span><a href="#memory-management-comparison" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h2></h2><p>In this section, I will be discussing about memory management in FreeBSD and Windows based on my research.</p><h3 id="freebsd-2"><span class="mr-2">FreeBSD</span><a href="#freebsd-2" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h3></h3><p>Berkeley Software Distribution (BSD) kernel handles process scheduling, memory management, symmetric multi-processing, device drivers, etc. In addition, for memory management in general, each process has its own private address and each address space is divided into 3 logical segments: text, data, and stack. For the text segment, it is read-only, has initialized and uninitialized data portions of a program, and, in most machines, a process can change the size of its text segment only when the segment’s contents are overlaid with data from the files system or when debugging in action. For the stack, it has application’s run-time stack and makes a system call in most machines. Lastly, initial contents of the segments of a child process are duplicated from the segments of a parent process. Moreover, for memory management inside the kernel, kernel often does allocation of memory that are needed for only the duration of a single system call, but in a user process, such as short-term memory, would be allocated on the run-time stack. Kernel’s memory isn’t feasible to allocate even moderate-sized blocks of memory on it because the kernel has a limited run-time stack <sup id="fnref:f7:3" role="doc-noteref"><a href="#fn:f7" class="footnote" rel="footnote">7</a></sup>.</p><p>For memory management, kernel can’t easily deal with memory allocation errors and often can’t scheme. Therefore, getting the memory in the kernel is more complicated than in user-space. Moreover, kernel treats phsical pages as the basic unit of memory management and kernel represents every phsical page on the system with a struct page structure, which is defined in &lt;linux/mm_types.h&gt; <sup id="fnref:f1:3" role="doc-noteref"><a href="#fn:f1" class="footnote" rel="footnote">1</a></sup>.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="iconfont icon-code small"></i></span> <span class="code-header-right"><button class="button-copy" aria-label="copy" title-succeed="Copied!"><i class="iconfont icon-copy"></i></button></span></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">struct</span> <span class="n">page</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">;</span>
    <span class="n">atomic_t</span> <span class="n">_count</span><span class="p">;</span>
    <span class="n">atomic_t</span> <span class="n">_mapcount</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">private</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">address_space</span> <span class="o">*</span><span class="n">mapping</span><span class="p">;</span>
    <span class="n">pgoff_t</span> <span class="n">index</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">list_head</span> <span class="n">lru</span><span class="p">;</span>
    <span class="kt">void</span> <span class="o">*</span><span class="k">virtual</span><span class="p">;</span>
<span class="p">};</span>
</pre></table></code></div></div><p>The kernel can’t treat all pages as the same because the hardware limitation. Therefore, some pages can’t be used for certain because of their physical address in memory. Hence, kernel uses the zones to group pages of similar properties. Linux partitions the system’s pages into zones to have a pooling in place to satisfy allocations as needed. Although some allocations may require pages from a partiular zone, other allocations my pull from multiple zones. Each zone is represented by a struct zone, which is defined in &lt;linux/mmzone.h&gt; <sup id="fnref:f1:4" role="doc-noteref"><a href="#fn:f1" class="footnote" rel="footnote">1</a></sup>.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="iconfont icon-code small"></i></span> <span class="code-header-right"><button class="button-copy" aria-label="copy" title-succeed="Copied!"><i class="iconfont icon-copy"></i></button></span></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="k">struct</span> <span class="n">zone</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">watermark</span><span class="p">[</span><span class="n">NR_WMARK</span><span class="p">];</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">lowmem_reserve</span><span class="p">[</span><span class="n">MAX_NR_ZONES</span><span class="p">];</span>
    <span class="k">struct</span> <span class="n">per_cpu_pageset</span> <span class="n">pageset</span><span class="p">[</span><span class="n">NR_CPUS</span><span class="p">];</span>
    <span class="n">spinlock_t</span> <span class="n">lock</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">free_area</span> <span class="n">free_area</span><span class="p">[</span><span class="n">MAX_ORDER</span><span class="p">]</span>
    <span class="n">spinlock_t</span> <span class="n">lru_lock</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">zone_lru</span> <span class="p">{</span>
        <span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
        <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">nr_saved_scan</span><span class="p">;</span>
    <span class="p">}</span> <span class="n">lru</span><span class="p">[</span><span class="n">NR_LRU_LISTS</span><span class="p">];</span>
    <span class="k">struct</span> <span class="n">zone_reclaim_stat</span> <span class="n">reclaim_stat</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">pages_scanned</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">;</span>
    <span class="n">atomic_long_t</span> <span class="n">vm_stat</span><span class="p">[</span><span class="n">NR_VM_ZONE_STAT_ITEMS</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">prev_priority</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">inactive_ratio</span><span class="p">;</span>
    <span class="n">wait_queue_head_t</span> <span class="o">*</span><span class="n">wait_table</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">wait_table_hash_nr_entries</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">wait_table_bits</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">pglist_data</span> <span class="o">*</span><span class="n">zone_pgdat</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">zone_start_pfn</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">spanned_pages</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">present_pages</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>
<span class="p">};</span>
</pre></table></code></div></div><p>Kmalloc() is similar to malloc() in user-space, but it is just a simple interface for obtaining kernel memory in byte-sized chunks and it can be used to allocate pages. For freeing pages, we can use kfree(), which is definded in &lt;linux/slab.h&gt;, kfree() frees a block of memory previously allocated with kmalloc() <sup id="fnref:f1:5" role="doc-noteref"><a href="#fn:f1" class="footnote" rel="footnote">1</a></sup>.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="iconfont icon-code small"></i></span> <span class="code-header-right"><button class="button-copy" aria-label="copy" title-succeed="Copied!"><i class="iconfont icon-copy"></i></button></span></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>    <span class="n">buf</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="n">BUF_SIZE</span><span class="p">,</span> <span class="n">GFP_ATOMIC</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">buf</span><span class="p">)</span>
    <span class="cm">/* error allocating memory ! */</span>
    <span class="p">...</span>
    <span class="n">kfree</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</pre></table></code></div></div><p>Free lists data structures are the default data structures in kernel. Due to the fact that allocating and freeing data structures is one of the most common operations inside any kernel has issues, slab layer is used to solve these issues. Slab layer acts as generic data structure-chaining layer and slab layer attempts to cache frequently used data structures as they tend to be allocated and freed often, prevent memory fragmentation, which is resulted from frequent allocation and deallocation, by cached free lists are arranged contiguously, and it has many other promises that slab layer attempts to provide <sup id="fnref:f1:6" role="doc-noteref"><a href="#fn:f1" class="footnote" rel="footnote">1</a></sup>.</p><h3 id="windows-2"><span class="mr-2">Windows</span><a href="#windows-2" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h3></h3><p>The memory manager in Windows implements virtual memory, provides a core set of services such as memory mapped files, copy-on-write memory, large memory support, and underlying support for the cache manager.The memory manager creates the two memory pools, non-paged pool and paged pool, that the system uses to allocate memory. Non-paged pool and paged pool are located in the region of the address space that is reserved for the system and mapped into the virtual address space of each process. For the non-paged pool, it consists of virtual memory addresses that are guaranteed to reside in physical memory as long as the corresponding kernel objects are allocated. For the paged pool, it consists of virtual memory that can be paged in and out of the system. To improve performance, systems with a single processor have three paged pools, and multiprocessor systems have five paged pools <sup id="fnref:f5:3" role="doc-noteref"><a href="#fn:f5" class="footnote" rel="footnote">5</a></sup>.</p><p>It seems that Windows uses VirtualAlloc() to use a page granularity, so using VirtualAlloc can result in higher memory usage and it allows you to specify additional options for memory allocation. In order to free pages, you need to use VirtualFree() <sup id="fnref:f5:4" role="doc-noteref"><a href="#fn:f5" class="footnote" rel="footnote">5</a></sup>.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="iconfont icon-code small"></i></span> <span class="code-header-right"><button class="button-copy" aria-label="copy" title-succeed="Copied!"><i class="iconfont icon-copy"></i></button></span></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">LPVOID</span> <span class="n">WINAPI</span> <span class="nf">VirtualAlloc</span><span class="p">(</span>
      <span class="n">_In_opt_</span> <span class="n">LPVOID</span> <span class="n">lpAddress</span><span class="p">,</span>
      <span class="n">_In_</span>     <span class="n">SIZE_T</span> <span class="n">dwSize</span><span class="p">,</span>
      <span class="n">_In_</span>     <span class="n">DWORD</span>  <span class="n">flAllocationType</span><span class="p">,</span>
      <span class="n">_In_</span>     <span class="n">DWORD</span>  <span class="n">flProtect</span>
<span class="p">);</span>
<span class="n">BOOL</span> <span class="n">WINAPI</span> <span class="nf">VirtualFree</span><span class="p">(</span>
      <span class="n">_In_</span> <span class="n">LPVOID</span> <span class="n">lpAddress</span><span class="p">,</span>
      <span class="n">_In_</span> <span class="n">SIZE_T</span> <span class="n">dwSize</span><span class="p">,</span>
      <span class="n">_In_</span> <span class="n">DWORD</span>  <span class="n">dwFreeType</span>
<span class="p">);</span>
</pre></table></code></div></div><h3 id="general-discussion-2"><span class="mr-2">General Discussion</span><a href="#general-discussion-2" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h3></h3><p>Windows and Linux has different memory management structures. In Windows, memory management uses tree data structures, uses cluster demand paging, brings 8 pages in memory simultaneously, and page replacements uses First In First Out (FIFO) algorithm. In the other hand, in Linux, memory management uses linked lists data stricture, uses demand paging with no pre-paging and it doesn’t swap the entire process instead it uses a lazy swapper, swaps the necessary pages into memory only to avoid reading pages that won’t be used, which decreases swap time and amount of physical memory required, and page replacement uses Least Recently Used (LRU) algorithm <sup id="fnref:f13" role="doc-noteref"><a href="#fn:f13" class="footnote" rel="footnote">13</a></sup>.</p><p>From my research, it seems that Windows is built for commercial use due it’s complex systems to handle large amount of data compared to linux and FreeBSD, and FreeBSD seems to follow most of Linux memory management style, but it is more stable than Linux by using different methods <sup id="fnref:f1:7" role="doc-noteref"><a href="#fn:f1" class="footnote" rel="footnote">1</a></sup><sup id="fnref:f5:5" role="doc-noteref"><a href="#fn:f5" class="footnote" rel="footnote">5</a></sup><sup id="fnref:f7:4" role="doc-noteref"><a href="#fn:f7" class="footnote" rel="footnote">7</a></sup><sup id="fnref:f13:1" role="doc-noteref"><a href="#fn:f13" class="footnote" rel="footnote">13</a></sup>.</p><h2 id="conclusion"><span class="mr-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h2></h2><p>To conclude, I have discussed about the differences and similarity between Linux, FreeBSD, and Windows in these areas: concurrency, I/O, and memory management. Therefore, based on my research and understanding, I conclude that FreeBSD and Linux are an excellent operating systems because of their system simplicity compared to Windows. However, Windows complexity was made for a certain purpose, which is commercial use. In addition, FreeBSD seems to be more stable and secure than Linux. Other than that, all of the systems have similar general architecture and data flow, but they vary in the way they implement and process these parts.</p><h2 id="references"><span class="mr-2">References</span><a href="#references" class="anchor text-muted"><i class="iconfont icon-hashtag"></i></a></h2></h2><div class="footnotes" role="doc-endnotes"><ol><li id="fn:f1" role="doc-endnote"><p>R. Love,Linux Kernel Development, 3rd ed. Addison-Wesley Professional, 2010. <a href="#fnref:f1" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:f1:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a> <a href="#fnref:f1:2" class="reversefootnote" role="doc-backlink">&#8617;<sup>3</sup></a> <a href="#fnref:f1:3" class="reversefootnote" role="doc-backlink">&#8617;<sup>4</sup></a> <a href="#fnref:f1:4" class="reversefootnote" role="doc-backlink">&#8617;<sup>5</sup></a> <a href="#fnref:f1:5" class="reversefootnote" role="doc-backlink">&#8617;<sup>6</sup></a> <a href="#fnref:f1:6" class="reversefootnote" role="doc-backlink">&#8617;<sup>7</sup></a> <a href="#fnref:f1:7" class="reversefootnote" role="doc-backlink">&#8617;<sup>8</sup></a></p><li id="fn:f2" role="doc-endnote"><p>Operating system-processes,”Available at https://www.tutorialspoint.com/operatingsystem/osprocesses.htm(2018/10/19). <a href="#fnref:f2" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:f2:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a></p><li id="fn:f3" role="doc-endnote"><p>A. Vara, “How to create process in linux (part 10/15),” Available at https://www.engineersgarage.com/tutorials/introduction-linux-part-1015. <a href="#fnref:f3" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:f4" role="doc-endnote"><p>M. K. McKusick, G. Neville-Neil, and R. N. Watson,The Design and Implementation of the FreeBSD Operating System, 2nd ed. Addison-Wesley Professional, 2014. <a href="#fnref:f4" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:f4:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a> <a href="#fnref:f4:2" class="reversefootnote" role="doc-backlink">&#8617;<sup>3</sup></a> <a href="#fnref:f4:3" class="reversefootnote" role="doc-backlink">&#8617;<sup>4</sup></a></p><li id="fn:f5" role="doc-endnote"><p>Memory management,” Available at https://docs.microsoft.com/en-us/windows/desktop/memory/memory-management(2018/05/30). <a href="#fnref:f5" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:f5:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a> <a href="#fnref:f5:2" class="reversefootnote" role="doc-backlink">&#8617;<sup>3</sup></a> <a href="#fnref:f5:3" class="reversefootnote" role="doc-backlink">&#8617;<sup>4</sup></a> <a href="#fnref:f5:4" class="reversefootnote" role="doc-backlink">&#8617;<sup>5</sup></a> <a href="#fnref:f5:5" class="reversefootnote" role="doc-backlink">&#8617;<sup>6</sup></a></p><li id="fn:f6" role="doc-endnote"><p>M. E. Russinovich, D. A. Solomon, and A. Ionescu,Windows Internals, Part 1: Covering Windows Server 2008 R2 and Windows 7,6th ed. Redmond, WA, USA: Microsoft Press, 2012. <a href="#fnref:f6" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:f6:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a></p><li id="fn:f7" role="doc-endnote"><p>M. K. McKusick, K. Bostic, M. J. Karels, and J. S. Quarterman,The Design and Implementation of the 4.4BSD Operating System.Redwood City, CA, USA: Addison Wesley Longman Publishing Co., Inc., 1996. <a href="#fnref:f7" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:f7:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a> <a href="#fnref:f7:2" class="reversefootnote" role="doc-backlink">&#8617;<sup>3</sup></a> <a href="#fnref:f7:3" class="reversefootnote" role="doc-backlink">&#8617;<sup>4</sup></a> <a href="#fnref:f7:4" class="reversefootnote" role="doc-backlink">&#8617;<sup>5</sup></a></p><li id="fn:f8" role="doc-endnote"><p>M. W. Lucas,Absolute Freebsd, 2Nd Edition, 2nd ed. San Francisco, CA, USA: No Starch Press, 2007. <a href="#fnref:f8" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:f8:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a></p><li id="fn:f9" role="doc-endnote"><p>M. E. Russinovich, D. A. Solomon, and A. Ionescu,Windows Internals, Part 2: Covering Windows Server 2008 R2 and Windows 7(Windows Internals). Redmond, WA, USA: Microsoft Press, 2012. <a href="#fnref:f9" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:f9:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a> <a href="#fnref:f9:2" class="reversefootnote" role="doc-backlink">&#8617;<sup>3</sup></a></p><li id="fn:f10" role="doc-endnote"><p>H. Haftmann, “Completing i/o requests,” Available at https://www-user.tu-chemnitz.de/∼heha/oneywdm/ch05d.htm. <a href="#fnref:f10" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:f11" role="doc-endnote"><p>B. Bruce and M. Stokely, “Freebsd vs. linux vs. windows 2000,” Available at https://people.freebsd.org/∼murray/bsdflier.html. <a href="#fnref:f11" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:f11:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a></p><li id="fn:f12" role="doc-endnote"><p>S. Hand, “Operating systems,” Available at https://www.cl.cam.ac.uk/teaching/1011/OpSystems/os1a-slides.pdf <a href="#fnref:f12" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:f12:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a></p><li id="fn:f13" role="doc-endnote"><p>U. Essays, “Compare the memory management of windows with linux,” Available at https://www.ukessays.com/essays/engineering/compare-the-memory-management.php (2016/12/05). <a href="#fnref:f13" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:f13:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a></p></ol></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="iconfont icon-FolderOpen-1"></i> <a href='/categories/os/'>OS</a>, <a href='/categories/analysis/'>Analysis</a></div><div class="post-tags"> <i class="iconfont icon-tag"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/freebsd/" class="post-tag no-text-decoration" >freebsd</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Linux+vs.+FreeBSD+vs.+Windows+-+Mazen&url=https%3A%2F%2Fma7.dev%2Fposts%2Flinux-vs-freebsd-vs-windows%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="iconfont icon-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Linux+vs.+FreeBSD+vs.+Windows+-+Mazen&u=https%3A%2F%2Fma7.dev%2Fposts%2Flinux-vs-freebsd-vs-windows%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="iconfont icon-facebook"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fma7.dev%2Fposts%2Flinux-vs-freebsd-vs-windows%2F&text=Linux+vs.+FreeBSD+vs.+Windows+-+Mazen" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="iconfont icon-telegram"></i> </a> <i id="copy-link" class="iconfont icon-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/exploring-robot/">[Project] Exploring Robot</a><li><a href="/posts/weekly-logs/">Weekly logs on Notion</a><li><a href="/posts/writing-notes/">How I write my notes [Part 1]</a><li><a href="/posts/linux-vs-freebsd-vs-windows/">Linux vs. FreeBSD vs. Windows</a><li><a href="/posts/tsp/">[Project] Travelling salesman problem</a></ul></div><div id="access-links"><div class="panel-heading">External Links</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="http://slow-science.org/" target="_blank"> <img src="https://img.shields.io/badge/link-slow_science-red.svg" alt="slow-science.org" /> </a><li><a href="https://github.com/ma7dev/ma7dev.github.io" target="_blank"> <i class="iconfont icon-nihil-github"></i> &nbsp;Github repository for this blog </a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/weekly-logs/"><div class="card-body"> <em class="timeago small" data-ts="1671868800" > 2022-12-24 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Weekly logs on Notion</h3><div class="text-muted small"><p> For the last 6 years, I have been interested in writing and sharing my thoughts. I have written tens of drafts for articles that I think are useful, worth reading, and interesting to others, or at ...</p></div></div></a></div><div class="card"> <a href="/posts/writing-notes/"><div class="card-body"> <em class="timeago small" data-ts="1659337200" > 2022-08-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How I write my notes [Part 1]</h3><div class="text-muted small"><p> In this post, I will share the tools that I use, my general thoughts about the setup, and an example of how I would go about writing a note. Here are the tools that I use to have an active and pro...</p></div></div></a></div><div class="card"> <a href="/posts/how-i-learn/"><div class="card-body"> <em class="timeago small" data-ts="1647846000" > 2022-03-21 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How I Learn</h3><div class="text-muted small"><p> Requirements iPad Laptop/PC Google Drive/DropBox/any cloud storage Consume the content When I read from an article, PDF, or any text-based resource, I follow the following rules: Use tw...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/exploring-robot/" class="btn btn-outline-primary" prompt="Older"><p>[Project] Exploring Robot</p></a> <a href="/posts/tsp/" class="btn btn-outline-primary" prompt="Newer"><p>[Project] Travelling salesman problem</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://ma7.dev/posts/linux-vs-freebsd-vs-windows/'; this.page.identifier = '/posts/linux-vs-freebsd-vs-windows/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://ma7.dev/">Mazen Alotaibi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme (fork: <a href="https://github.com/nichtshsu/nichtshsu.github.io" target="_blank" rel="noopener">nichtshsu</a>).</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notion/">notion</a> <a class="post-tag" href="/tags/obsidian/">obsidian</a> <a class="post-tag" href="/tags/freebsd/">freebsd</a> <a class="post-tag" href="/tags/insync/">insync</a> <a class="post-tag" href="/tags/learn/">learn</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/mathpix/">mathpix</a> <a class="post-tag" href="/tags/okular/">okular</a> <a class="post-tag" href="/tags/project/">project</a> <a class="post-tag" href="/tags/robots/">robots</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="iconfont icon-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="iconfont icon-folder"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="iconfont icon-tag"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-RK9LRGVP0T"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-RK9LRGVP0T'); }); </script>
